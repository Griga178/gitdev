

## Модуль парсинга КТРУ

Модуль содержит функции для парсинга характеристик КТРУ с сайта **zakupki.gov**.

Основные возможности модуля:

- Получение информации о КТРУ по номеру с сайта.
- Парсинг версии КТРУ и характеристик.
- Интеграция с базой данных.

### Методы

- **get_ktru_info(ktru_number, version=None)**  
  - Запрашивает информацию по номеру КТРУ.  
  - Если КТРУ с таким номером есть в базе — возвращает сохранённые данные.  
  - Если отсутствует в базе — запускает функцию парсинг, сохраняет в БД и возвращает их пользователю.

## Таблицы

- **ktru**  
  Хранит основные данные по КТРУ:  
  - `id` — уникальный идентификатор (целое число)  
  - `number` — номер КТРУ (текст, уникальный)  
  - `name` — наименование КТРУ (текст)  
  - `unit` — единица измерения (текст)  
  - `ownCharsIsForbidden` — запрет задания собственных характеристик (логический тип)

- **ktruVersion**  
  Версии КТРУ, связанные с конкретным элементом из таблицы ktru:  
  - `id` — уникальный идентификатор  
  - `ktruId` — внешний ключ на таблицу ktru  
  - `versionNumber` — номер версии (целое число)  
  - `dateUpdate` — дата обновления версии (дата и время)

- **ktruChars**  
  Характеристики КТРУ для каждой версии:  
  - `id` — уникальный идентификатор  
  - `ktruVersionId` — внешний ключ на таблицу ktruVersion  
  - `name` — название характеристики (текст)  
  - `values` — возможные значения характеристики (текст)  
  - `unit` — единица измерения характеристики (текст)

- **requests**  
  Сохранение информации о запросах к сайту:  
  - `id` — уникальный идентификатор  
  - `isSuccess` — результат запроса (логический тип)  
  - `ktruNumber` — номер КТРУ, по которому был запрос (текст)  
  - `ktruVersion` — версия КТРУ (целое число)  
  - `date` — дата и время запроса (дата и время)

## Структура проекта

> project/

> > controller/
> > > init.py
> > > controller.py     — высокоуровневая логика, координация

> > db/
> > > init.py
> > > client.py         — обёртка по работе с БД (подключение, сессии)
> > > queries.py        — CRUD ─ функции, SQL ─ запросы
> > > models.py         — ORM ─ модели для БД

> > z_parser/
> > > init.py
> > > fetcher.py        — HTTP - клиенты, получение сырого контента
> > > extractor.py      — парсинг/извлечение данных (BeautifulSoup, regex и т.п.)

> > services/
> > > init.py
> > > business.py       — бизнес ─ логика, объединение парсера и БД

> > settings.py
> > README.md

## requirements:
requests
beautifulsoup4
sqlalchemy
pytest
requests-mock
